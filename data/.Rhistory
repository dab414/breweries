yelp$name <- tolower(gsub(' ', '', yelp$name, fixed=TRUE))
library(data.table)
yelp <- read.csv('business.csv')
brew <- read.csv('breweries.csv')
yelp$name <- tolower(gsub(' ', '', yelp$name, fixed=TRUE))
library(tidyverse)
head(yelp$name)
brew$name <- tolower(gsub(' ', '', brew$name, fixed=TRUE))
df <- brew %>%
inner_join(yelp)
head(df)
df <- brew %>%
inner_join(yelp, by = 'name')
head(df)
colnames(yelp)
head(yelp)
yelp2 <- yelp %>%
select(name, -(contains('attributes')))
colnames(yelp)
colnames(yelp2)
yelp2 <- yelp %>%
select(-(contains('attributes')))
colnames(yelp2)
head(yelp2)
yelp <- yelp %>%
select(name, review_count, stars)
df <- brew %>%
inner_join(yelp, by = 'name')
head(df)
nrow(df)
typeof(df$review_count)
typeof(df$stars)
sDf <- df %>%
mutate(weightProduct = review_count * stars) %>%
group_by(state) %>%
summarize(weightSum = sum(weightProduct), totalReviews = sum(review_count)) %>%
mutate(weightAverage = weightSum / totalReviews)
head(sDf)
1476/440+
1476/440
ggplot(sDf, aes(x = reorder(state, weightAverage, sum), y = weightAverage, group = 1)) + geom_line() + coord_flip()
'Vermont' %in% df$state
'California' %in% df$state
q()
## libraries and import and filter data
library(tidyverse)
df <- read.csv('breweries.csv')
popData <- read.csv('scprc-est2017-18+pop-res.csv')
popData <- popData %>%
filter(NAME != 'United States' & NAME != 'Puerto Rico Commonwealth')
df <- df %>%
filter(state != '' & state != 'FL San', brewery_type != 'bar')
## COMPUTE FIGURE 1
stateFreq <- df %>%
group_by(state) %>%
summarize(freq = n()) %>%
arrange(freq)
stateFreq <- popData %>%
select(NAME, POPESTIMATE2017) %>%
rename(state = NAME) %>%
inner_join(stateFreq)
stateFreq <- stateFreq %>%
mutate(pplToBeer = POPESTIMATE2017 / freq)
# count plot
ggplot(stateFreq, aes(x = reorder(state, freq, sum), y = freq, group = 1)) + geom_line() + coord_flip() + xlab('State') + ylab('Number of Breweries')
# ratio plot
ggplot(stateFreq, aes(x = reorder(state, pplToBeer, sum), y = pplToBeer, group = 1)) + geom_line() + coord_flip() + xlab('State (increasing in ratio of people to breweries)') +
ylab('Ratio of Number of People to Number of Breweries')
## COMPUTE FIGURE 1
stateFreq <- df %>%
group_by(state) %>%
summarize(freq = n()) %>%
arrange(freq)
stateFreq <- popData %>%
select(NAME, POPESTIMATE2017) %>%
rename(state = NAME) %>%
inner_join(stateFreq)
stateFreq <- stateFreq %>%
mutate(pplToBeer = POPESTIMATE2017 / freq,
beerToPpl = freq / POPESTIMATE2017)
# count plot
ggplot(stateFreq, aes(x = reorder(state, freq, sum), y = freq, group = 1)) + geom_line() + coord_flip() + xlab('State') + ylab('Number of Breweries')
# ratio plot
ggplot(stateFreq, aes(x = reorder(state, beerToPpl, sum), y = beerToPpl, group = 1)) + geom_line() + coord_flip() + xlab('State (increasing in ratio of people to breweries)') +
ylab('Ratio of Number of People to Number of Breweries')
# ratio plot
ggplot(stateFreq, aes(x = reorder(state, beerToPpl, sum), y = beerToPpl, group = 1)) + geom_line() + coord_flip() + xlab('State (increasing in ratio of people to breweries)') +
ylab('Ratio of Number of People to Number of Breweries') + theme(axis.text.x = element_blank())
# ratio plot
ggplot(stateFreq, aes(x = reorder(state, beerToPpl, sum), y = beerToPpl, group = 1)) + geom_line() + coord_flip() + xlab('State (increasing in ratio of people to breweries)') +
ylab('Ratio of Number of People to Number of Breweries') + theme(axis.text.x = element_blank(), axis.ticks.x = element_blank())
```{r fig.width=10, fig.height=8}
```{r, fig.width=10, fig.height=8}
# count plot
ggplot(stateFreq, aes(x = reorder(state, freq, sum), y = freq, group = 1)) + geom_line() + coord_flip() + xlab('State') + ylab('Number of Breweries')
q()
library(tidyverse)
df <- read.csv('breweries.csv')
popData <- read.csv('scprc-est2017-18+pop-res.csv')
popData <- popData %>%
filter(NAME != 'United States' & NAME != 'Puerto Rico Commonwealth')
df <- df %>%
filter(state != '' & state != 'FL San', brewery_type != 'bar')
df <- df %>%
mutate('climateZones' = ifelse(latitude < 34, 'Warm', ifelse(latitude >= 34 & latitude < 49, 'Temperate', ifelse(latitude >= 49, 'Cool',''))))
climateFreq <- df %>%
filter(!is.na(latitude)) %>%
group_by(brewery_type, climateZones) %>%
summarize(freq = n())
ggplot(climateFreq, aes(x = brewery_type, y = freq, group = climateZones)) + geom_bar(stat = 'identity', aes(fill = climateZones), position = position_dodge(width = .9)) + xlab('Brewery Type') +
ylab('Number of Breweries') + scale_fill_discrete(name = 'Climate Zones')
q()
